!function(a){void 0==a.fn.ajaxForm&&a.getScript(("https:"==document.location.protocol?"https://":"http://")+"malsup.github.io/jquery.form.js");var b={};b.fileapi=void 0!==a("<input type='file'/>").get(0).files,b.formdata=void 0!==window.FormData,a.fn.uploadFile=function(c){function k(){j||(j=!0,function a(){if(d.sequential||(d.sequentialCount=99999),0==h.length&&0==i.length)d.afterUploadAll&&d.afterUploadAll(f),j=!1;else{if(i.length<d.sequentialCount){var b=h.shift();void 0!=b&&(i.push(b),b.removeClass(f.formGroup),b.submit())}window.setTimeout(a,100)}}())}function l(b,c,d){d.on("dragenter",function(b){b.stopPropagation(),b.preventDefault(),a(this).addClass(c.dragDropHoverClass)}),d.on("dragover",function(b){b.stopPropagation(),b.preventDefault();var d=a(this);d.hasClass(c.dragDropContainerClass)&&!d.hasClass(c.dragDropHoverClass)&&d.addClass(c.dragDropHoverClass)}),d.on("drop",function(d){d.preventDefault(),a(this).removeClass(c.dragDropHoverClass),b.errorLog.html("");var e=d.originalEvent.dataTransfer.files;return!c.multiple&&e.length>1?void(c.showError&&a("<div class='"+c.errorClass+"'>"+c.multiDragErrorStr+"</div>").appendTo(b.errorLog)):void(0!=c.onSelect(e)&&p(c,b,e))}),d.on("dragleave",function(b){a(this).removeClass(c.dragDropHoverClass)}),a(document).on("dragenter",function(a){a.stopPropagation(),a.preventDefault()}),a(document).on("dragover",function(b){b.stopPropagation(),b.preventDefault();var d=a(this);d.hasClass(c.dragDropContainerClass)||d.removeClass(c.dragDropHoverClass)}),a(document).on("drop",function(b){b.stopPropagation(),b.preventDefault(),a(this).removeClass(c.dragDropHoverClass)})}function m(a){var b="",c=a/1024;if(parseInt(c)>1024){var d=c/1024;b=d.toFixed(2)+" MB"}else b=c.toFixed(2)+" KB";return b}function n(b){var c=[];c="string"==jQuery.type(b)?b.split("&"):a.param(b).split("&");var f,g,d=c.length,e=[];for(f=0;f<d;f++)c[f]=c[f].replace(/\+/g," "),g=c[f].split("="),e.push([decodeURIComponent(g[0]),decodeURIComponent(g[1])]);return e}function p(b,c,d){for(var e=0;e<d.length;e++)if(q(c,b,d[e].name))if(b.allowDuplicates||!r(c,d[e].name))if(b.maxFileSize!=-1&&d[e].size>b.maxFileSize)b.showError&&a("<div class='"+b.errorClass+"'><b>"+d[e].name+"</b> "+b.sizeErrorStr+m(b.maxFileSize)+"</div>").appendTo(c.errorLog);else if(b.maxFileCount!=-1&&c.selectedFiles>=b.maxFileCount)b.showError&&a("<div class='"+b.errorClass+"'><b>"+d[e].name+"</b> "+b.maxFileCountErrorStr+b.maxFileCount+"</div>").appendTo(c.errorLog);else{c.selectedFiles++,c.existingFileNames.push(d[e].name);var f=b,g=new FormData,h=b.fileName.replace("[]","");g.append(h,d[e]);var i=b.formData;if(i)for(var j=n(i),k=0;k<j.length;k++)j[k]&&g.append(j[k][0],j[k][1]);f.fileData=g;var l=new x(c,b),o="";o=b.showFileCounter?c.fileCounter+b.fileCounterStyle+d[e].name:d[e].name,b.showFileSize&&(o+=" ("+m(d[e].size)+")"),l.filename.html(o);var p=a("<form style='display:block; position:absolute;left: 150px;' class='"+c.formGroup+"' method='"+b.method+"' action='"+b.url+"' enctype='"+b.enctype+"'></form>");p.appendTo("body");var s=[];s.push(d[e].name),y(p,f,l,s,c,d[e]),c.fileCounter++}else b.showError&&a("<div class='"+b.errorClass+"'><b>"+d[e].name+"</b> "+b.duplicateErrorStr+"</div>").appendTo(c.errorLog);else b.showError&&a("<div class='"+b.errorClass+"'><b>"+d[e].name+"</b> "+b.extErrorStr+b.allowedTypes+"</div>").appendTo(c.errorLog)}function q(a,b,c){var d=b.allowedTypes.toLowerCase().split(/[\s,]+/g),e=c.split(".").pop().toLowerCase();return!("*"!=b.allowedTypes&&jQuery.inArray(e,d)<0)}function r(a,b){var c=!1;if(a.existingFileNames.length)for(var e=0;e<a.existingFileNames.length;e++)(a.existingFileNames[e]==b||d.duplicateStrict&&a.existingFileNames[e].toLowerCase()==b.toLowerCase())&&(c=!0);return c}function s(a,b){if(a.existingFileNames.length)for(var c=0;c<b.length;c++){var d=a.existingFileNames.indexOf(b[c]);d!=-1&&a.existingFileNames.splice(d,1)}}function t(a,b){if(a){b.show();var c=new FileReader;c.onload=function(a){b.attr("src",a.target.result)},c.readAsDataURL(a)}}function u(b,c){if(b.showFileCounter){var d=a(c.container).find(".ajax-file-upload-filename").length;c.fileCounter=d+1,a(c.container).find(".ajax-file-upload-filename").each(function(c,e){var f=a(this).html().split(b.fileCounterStyle),h=(parseInt(f[0])-1,d+b.fileCounterStyle+f[1]);a(this).html(h),d--})}}function v(c,d,e,f){var g="ajax-upload-id-"+(new Date).getTime(),h=a("<form method='"+e.method+"' action='"+e.url+"' enctype='"+e.enctype+"'></form>"),i="<input type='file' id='"+g+"' name='"+e.fileName+"' accept='"+e.acceptFiles+"'/>";e.multiple&&(e.fileName.indexOf("[]")!=e.fileName.length-2&&(e.fileName+="[]"),i="<input type='file' id='"+g+"' name='"+e.fileName+"' accept='"+e.acceptFiles+"' multiple/>");var j=a(i).appendTo(h);j.change(function(){c.errorLog.html("");var i=(e.allowedTypes.toLowerCase().split(","),[]);if(this.files){for(n=0;n<this.files.length;n++)i.push(this.files[n].name);if(0==e.onSelect(this.files))return}else{var j=a(this).val(),k=[];if(i.push(j),!q(c,e,j))return void(e.showError&&a("<div class='"+e.errorClass+"'><b>"+j+"</b> "+e.extErrorStr+e.allowedTypes+"</div>").appendTo(c.errorLog));if(k.push({name:j,size:"NA"}),0==e.onSelect(k))return}if(u(e,c),f.unbind("click"),h.hide(),v(c,d,e,f),h.addClass(d),e.serialize&&b.fileapi&&b.formdata){h.removeClass(d);var l=this.files;h.remove(),p(e,c,l)}else{for(var m="",n=0;n<i.length;n++)m+=e.showFileCounter?c.fileCounter+e.fileCounterStyle+i[n]+"<br>":i[n]+"<br>",c.fileCounter++;if(e.maxFileCount!=-1&&c.selectedFiles+i.length>e.maxFileCount)return void(e.showError&&a("<div class='"+e.errorClass+"'><b>"+m+"</b> "+e.maxFileCountErrorStr+e.maxFileCount+"</div>").appendTo(c.errorLog));c.selectedFiles+=i.length;var o=new x(c,e);o.filename.html(m),y(h,e,o,i,c,null)}}),e.nestedForms?(h.css({margin:0,padding:0}),f.css({position:"relative",overflow:"hidden",cursor:"default"}),j.css({position:"absolute",cursor:"pointer",top:"0px",width:"100%",height:"100%",left:"0px","z-index":"100",opacity:"0.0",filter:"alpha(opacity=0)","-ms-filter":"alpha(opacity=0)","-khtml-opacity":"0.0","-moz-opacity":"0.0"}),h.appendTo(f)):(h.appendTo(a("body")),h.css({margin:0,padding:0,display:"block",position:"absolute",left:"-250px"}),navigator.appVersion.indexOf("MSIE ")!=-1?f.attr("for",g):f.click(function(){j.click()}))}function w(b,c){return this.statusbar=a("<div class='ajax-file-upload-statusbar'></div>").width(c.statusBarWidth),this.preview=a("<img class='ajax-file-upload-preview' />").width(c.previewWidth).height(c.previewHeight).appendTo(this.statusbar).hide(),this.filename=a("<div class='ajax-file-upload-filename'></div>").appendTo(this.statusbar),this.progressDiv=a("<div class='ajax-file-upload-progress'>").appendTo(this.statusbar).hide(),this.progressbar=a("<div class='ajax-file-upload-bar'></div>").appendTo(this.progressDiv),this.abort=a("<div>"+c.abortStr+"</div>").appendTo(this.statusbar).hide(),this.cancel=a("<div>"+c.cancelStr+"</div>").appendTo(this.statusbar).hide(),this.done=a("<div>"+c.doneStr+"</div>").appendTo(this.statusbar).hide(),this.download=a("<div>"+c.downloadStr+"</div>").appendTo(this.statusbar).hide(),this.del=a("<div>"+c.deletelStr+"</div>").appendTo(this.statusbar).hide(),this.abort.addClass("ajax-file-upload-red"),this.done.addClass("ajax-file-upload-green"),this.download.addClass("ajax-file-upload-green"),this.cancel.addClass("ajax-file-upload-red"),this.del.addClass("ajax-file-upload-red"),this}function x(b,c){var d=null;return d=c.customProgressBar?new c.customProgressBar(b,c):new w(b,c),d.abort.addClass(b.formGroup),d.abort.addClass(c.abortButtonClass),d.cancel.addClass(b.formGroup),d.cancel.addClass(c.cancelButtonClass),c.extraHTML&&(d.extraHTML=a("<div class='extrahtml'>"+c.extraHTML()+"</div>").insertAfter(d.filename)),"bottom"==c.uploadQueueOrder?a(b.container).append(d.statusbar):a(b.container).prepend(d.statusbar),d}function y(c,d,e,f,g,j){var m={cache:!1,contentType:!1,processData:!1,forceSync:!1,type:d.method,data:d.formData,formData:d.fileData,dataType:d.returnType,headers:d.headers,beforeSubmit:function(b,i,j){if(0!=d.onSubmit.call(this,f)){if(d.dynamicFormData){var k=n(d.dynamicFormData());if(k)for(var l=0;l<k.length;l++)k[l]&&(void 0!=d.fileData?j.formData.append(k[l][0],k[l][1]):j.data[k[l][0]]=k[l][1])}return d.extraHTML&&a(e.extraHTML).find("input,select,textarea").each(function(b,c){void 0!=d.fileData?j.formData.append(a(this).attr("name"),a(this).val()):j.data[a(this).attr("name")]=a(this).val()}),!0}return e.statusbar.append("<div class='"+d.errorClass+"'>"+d.uploadErrorStr+"</div>"),e.cancel.show(),c.remove(),e.cancel.click(function(){h.splice(h.indexOf(c),1),s(g,f),e.statusbar.remove(),d.onCancel.call(g,f,e),g.selectedFiles-=f.length,u(d,g)}),!1},beforeSend:function(a,c){for(var h in c.headers)a.setRequestHeader(h,c.headers[h]);e.progressDiv.show(),e.cancel.hide(),e.done.hide(),d.showAbort&&(e.abort.show(),e.abort.click(function(){s(g,f),a.abort(),g.selectedFiles-=f.length,d.onAbort.call(g,f,e)})),b.formdata?e.progressbar.width("1%"):e.progressbar.width("5%")},uploadProgress:function(a,b,c,f){f>98&&(f=98);var g=f+"%";f>1&&e.progressbar.width(g),d.showProgress&&(e.progressbar.html(g),e.progressbar.css("text-align","center"))},success:function(b,h,j){if(e.cancel.remove(),i.pop(),"json"==d.returnType&&"object"==a.type(b)&&b.hasOwnProperty(d.customErrorKeyStr)){e.abort.hide();var k=b[d.customErrorKeyStr];return d.onError.call(this,f,200,k,e),d.showStatusAfterError?(e.progressDiv.hide(),e.statusbar.append("<span class='"+d.errorClass+"'>ERROR: "+k+"</span>")):(e.statusbar.hide(),e.statusbar.remove()),g.selectedFiles-=f.length,void c.remove()}g.responses.push(b),e.progressbar.width("100%"),d.showProgress&&(e.progressbar.html("100%"),e.progressbar.css("text-align","center")),e.abort.hide(),d.onSuccess.call(this,f,b,j,e),d.showStatusAfterSuccess?(d.showDone?(e.done.show(),e.done.click(function(){e.statusbar.hide("slow"),e.statusbar.remove()})):e.done.hide(),d.showDelete?(e.del.show(),e.del.click(function(){s(g,f),e.statusbar.hide().remove(),d.deleteCallback&&d.deleteCallback.call(this,b,e),g.selectedFiles-=f.length,u(d,g)})):e.del.hide()):(e.statusbar.hide("slow"),e.statusbar.remove()),d.showDownload&&(e.download.show(),e.download.click(function(){d.downloadCallback&&d.downloadCallback(b,e)})),c.remove()},error:function(a,b,h){e.cancel.remove(),i.pop(),e.abort.hide(),"abort"==a.statusText?(e.statusbar.hide("slow").remove(),u(d,g)):(d.onError.call(this,f,b,h,e),d.showStatusAfterError?(e.progressDiv.hide(),e.statusbar.append("<span class='"+d.errorClass+"'>ERROR: "+h+"</span>")):(e.statusbar.hide(),e.statusbar.remove()),g.selectedFiles-=f.length),c.remove()}};d.showPreview&&null!=j&&"image"==j.type.toLowerCase().split("/").shift()&&t(j,e.preview),d.autoSubmit?(c.ajaxForm(m),h.push(c),k()):(d.showCancel&&(e.cancel.show(),e.cancel.click(function(){h.splice(h.indexOf(c),1),s(g,f),c.remove(),e.statusbar.remove(),d.onCancel.call(g,f,e),g.selectedFiles-=f.length,u(d,g)})),c.ajaxForm(m))}var d=a.extend({url:"",method:"POST",enctype:"multipart/form-data",returnType:null,allowDuplicates:!0,duplicateStrict:!1,allowedTypes:"*",acceptFiles:"*",fileName:"file",formData:!1,dynamicFormData:!1,maxFileSize:-1,maxFileCount:-1,multiple:!0,dragDrop:!0,autoSubmit:!0,showCancel:!0,showAbort:!0,showDone:!1,showDelete:!1,showError:!0,showStatusAfterSuccess:!0,showStatusAfterError:!0,showFileCounter:!0,fileCounterStyle:"). ",showFileSize:!0,showProgress:!1,nestedForms:!0,showDownload:!1,onLoad:function(a){},onSelect:function(a){return!0},onSubmit:function(a,b){},onSuccess:function(a,b,c,d){},onError:function(a,b,c,d){},onCancel:function(a,b){},onAbort:function(a,b){},downloadCallback:!1,deleteCallback:!1,afterUploadAll:!1,serialize:!0,sequential:!1,sequentialCount:2,customProgressBar:!1,abortButtonClass:"ajax-file-upload-abort",cancelButtonClass:"ajax-file-upload-cancel",dragDropContainerClass:"ajax-upload-dragdrop",dragDropHoverClass:"state-hover",errorClass:"ajax-file-upload-error",uploadButtonClass:"ajax-file-upload",dragDropStr:"<span><b>Drag &amp; Drop Files</b></span>",uploadStr:"Upload",abortStr:"Abort",cancelStr:"Cancel",deletelStr:"Delete",doneStr:"Done",multiDragErrorStr:"Multiple File Drag &amp; Drop is not allowed.",extErrorStr:"is not allowed. Allowed extensions: ",duplicateErrorStr:"is not allowed. File already exists.",sizeErrorStr:"is not allowed. Allowed Max size: ",uploadErrorStr:"Upload is not allowed",maxFileCountErrorStr:" is not allowed. Maximum allowed files are:",downloadStr:"Download",customErrorKeyStr:"jquery-upload-file-error",showQueueDiv:!1,statusBarWidth:400,dragdropWidth:400,showPreview:!1,previewHeight:"auto",previewWidth:"100%",extraHTML:!1,uploadQueueOrder:"top",headers:{}},c);this.fileCounter=1,this.selectedFiles=0;var e="ajax-file-upload-"+(new Date).getTime();this.formGroup=e,this.errorLog=a("<div></div>"),this.responses=[],this.existingFileNames=[],b.formdata||(d.dragDrop=!1),b.formdata&&1!==d.maxFileCount||(d.multiple=!1),a(this).html("");var f=this,g=a("<div>"+d.uploadStr+"</div>");a(g).addClass(d.uploadButtonClass),function b(){if(a.fn.ajaxForm){if(d.dragDrop){var c=a('<div class="'+d.dragDropContainerClass+'" style="vertical-align:top;"></div>').width(d.dragdropWidth);a(f).append(c),a(c).append(g),a(c).append(a(d.dragDropStr)),l(f,d,c)}else a(f).append(g);a(f).append(f.errorLog),d.showQueueDiv?f.container=a("#"+d.showQueueDiv):f.container=a("<div class='ajax-file-upload-container'></div>").insertAfter(a(f)),d.onLoad.call(this,f),v(f,e,d,g)}else window.setTimeout(b,10)}(),this.startUpload=function(){a("form").each(function(b,c){a(this).hasClass(f.formGroup)&&h.push(a(this))}),h.length>=1&&k()},this.getFileCount=function(){return f.selectedFiles},this.stopUpload=function(){a("."+d.abortButtonClass).each(function(b,c){a(this).hasClass(f.formGroup)&&a(this).click()}),a("."+d.cancelButtonClass).each(function(b,c){a(this).hasClass(f.formGroup)&&a(this).click()})},this.cancelAll=function(){a("."+d.cancelButtonClass).each(function(b,c){a(this).hasClass(f.formGroup)&&a(this).click()})},this.update=function(b){d=a.extend(d,b)},this.reset=function(a){f.fileCounter=1,f.selectedFiles=0,f.errorLog.html(""),0!=a&&f.container.html("")},this.remove=function(){f.container.html(""),a(f).remove()},this.createProgress=function(a,b,c){var e=new x(this,d);e.progressDiv.show(),e.progressbar.width("100%");var g="";return g=d.showFileCounter?f.fileCounter+d.fileCounterStyle+a:a,d.showFileSize&&(g+=" ("+m(c)+")"),e.filename.html(g),f.fileCounter++,f.selectedFiles++,d.showPreview&&(e.preview.attr("src",b),e.preview.show()),d.showDownload&&(e.download.show(),e.download.click(function(){d.downloadCallback&&d.downloadCallback.call(f,[a],e)})),d.showDelete&&(e.del.show(),e.del.click(function(){e.statusbar.hide().remove();var b=[a];d.deleteCallback&&d.deleteCallback.call(this,b,e),f.selectedFiles-=1,u(d,f)})),e},this.getResponses=function(){return this.responses};var h=[],i=[],j=!1;return this}}(jQuery);