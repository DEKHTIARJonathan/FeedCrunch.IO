{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
	<head>

		<!-- Title -->
		<title>FeedCrunch.IO | Administration Dashboard</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta charset="UTF-8">
		<meta name="description" content="FeedCrunch.IO | Administration Dashboard" />
		<meta name="keywords" content="administration,dashboard, feedcrunch, rss" />
		<meta name="author" content="Jonathan DEKHTIAR" />

		<link href="{% static "images/favicon.ico" %}" rel="shortcut icon">

		<link rel="apple-touch-icon" sizes="60x60" href="{% static "onboarding/img/icons/touch-icon-iphone-60x60.png" %}">
		<link rel="apple-touch-icon" sizes="76x76" href="{% static "onboarding/img/icons/touch-icon-ipad-76x76.png" %}">
		<link rel="apple-touch-icon" sizes="114x114" href="{% static "onboarding/img/icons/touch-icon-iphone-retina-120x120.png" %}">
		<link rel="apple-touch-icon" sizes="144x144" href="{% static "onboarding/img/icons/touch-icon-ipad-retina-152x152.png" %}">

		<!-- Fonts -->
		<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link type="text/css" rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

		<!-- Styles -->
		<link type="text/css" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="{% static "plugins/materialize/css/materialize.min.css" %}"/>
		<link type="text/css" rel="stylesheet" href="{% static "plugins/metrojs/MetroJs.min.css" %}"/>
		<link type="text/css" rel="stylesheet" href="{% static "plugins/sweetalert/sweetalert.css" %}">

		<!-- Theme Styles -->
		<link type="text/css" rel="stylesheet" href="{% static "css/alpha.min.css" %}"/>
		<link type="text/css" rel="stylesheet" href="{% static "onboarding/css/onboarding.css" %}">

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="http://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="http://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<div class="loader-bg"></div>
		<div class="loader">
			<div class="preloader-wrapper big active">
				<div class="spinner-layer spinner-blue">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div><div class="gap-patch">
					<div class="circle"></div>
					</div><div class="circle-clipper right">
					<div class="circle"></div>
					</div>
				</div>
				<div class="spinner-layer spinner-spinner-teal lighten-1">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div><div class="gap-patch">
					<div class="circle"></div>
					</div><div class="circle-clipper right">
					<div class="circle"></div>
					</div>
				</div>
				<div class="spinner-layer spinner-yellow">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div><div class="gap-patch">
					<div class="circle"></div>
					</div><div class="circle-clipper right">
					<div class="circle"></div>
					</div>
				</div>
				<div class="spinner-layer spinner-green">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div><div class="gap-patch">
					<div class="circle"></div>
					</div><div class="circle-clipper right">
					<div class="circle"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="mn-content valign-wrapper">
			<header class="mn-header navbar-fixed">
				<nav class="indigo accent-3">
					<div class="nav-wrapper row">
						<div class="header-title col s3 m3">
							<a href="/"><img src="{% static "images/logo-white.png" %}" style="height:15px;"></a>
						</div>
						<form class="left search col s6 hide-on-small-and-down">
							<div class="input-field">
								<input id="search" type="search" placeholder="Search" autocomplete="off">
								<label for="search"><i class="material-icons search-icon">search</i></label>
							</div>
							<a href="javascript: void(0)" class="close-search"><i class="material-icons">close</i></a>
						</form>
					</div>
				</nav>
			</header>
			<main class="mn-inner">
				<div class="row">
					<!-- progressbar -->
					<ul id="progressbar" class="msform">
						<li class="active">Interests Selection</li>
						<li>Social Profiles</li>
						<li>Personal Details</li>
					</ul>
					<!-- fieldsets -->
					<fieldset>
						<div class="col-md-12">
							<div class="col-lg-3 hidden-md-down side-panel">
								<div class="header text-center">
									<h1>
										How does it work ?
									</h1>
								</div>
								<div class="explainer">
									<h2>Follow</h2>
									<p>Our personalization workflow starts to work once you have selected 3 interests to follow.</p>
									<h2>Reading and Reading</h2>
									<p>Next, we track which content you read and share</p>
									<h2>Learn</h2>
									<p>Based on your actions, your reading experience will be increasingly personalised to your interests.</p>
								</div>
								<div class="read-blog">
									<div class="aligner">
										<p>Read the technical deep-dive about personalization</p><a href="https://blog.feedcrunch.io/" target="_blank" class="btn btn-outline-primary btn-blog">Read More</a></div>
								</div>
							</div>
							<div class="topics col-lg-9 col-md-12">
								{% for interest in interests %}
								<div class="topic col-lg-3 col-md-6 col-sm-12">
									<input type="checkbox" class="interest-checkbox" id="topic-{{ interest.guid }}" data-name="{{ interest.name }}">
									<label for="topic-{{ interest.guid }}" class="interest-lbl" style='background-image: url("{{ interest.get_photo_path }}");'>
										<span>{{ interest.name }}</span>
									</label>
								</div>
								{% endfor %}

							</div>
						</div>
						<div class="col-md-12">
							<button type="button" id="interests-btn" class="btn blue darken-2 m-b-xs next" disabled>Select 3 Interests to Continue ...</button>
						</div>
					</fieldset>
					<fieldset>
						<div class="col-md-12">
							<div class="col-lg-3 hidden-md-down side-panel">
								<div class="header text-center">
									<h1>
										Why Linking Your Accounts
									</h1>
								</div>
								<div class="explainer">
									<h2>Social Sharing</h2>
									<p>You have the opportunity to share your daily readings on the most famous social platforms.</p>

									<h2>Create a Community</h2>
									<p>Position yourself as an authority in your domain and build a community around your shares.</p>

									<h2>Create Opportunities</h2>
									<p>Help your followers to find the best contents everyday, it will be rewardful.</p>
								</div>
								<div class="read-blog">
									<div class="aligner">
										<p>Read the technical deep-dive about personalization</p><a href="https://blog.feedcrunch.io/" target="_blank" class="btn btn-outline-primary btn-blog">Read More</a></div>
								</div>
							</div>
							<div class="topics col-lg-9 col-md-12">
								<div class="row">

									<!-- Twitter Card -->
									<div class="col s12 m6">
										<div class="white">
											<div class="card" id="profile-page-header">
												<div class="card-image header-img">
													<img alt="user background" class="activator" src="{% static "images/social-logos/bg-tw.jpg" %}">
												</div>
												<figure class="card-profile-image">
													<img alt="profile image" class="circle z-depth-2 responsive-imgMod activator" src="{% static "images/social-logos/twitter.png" %}">
												</figure>
												<div class="card-content">
													<div class="row social-btn-row">
														<div class="col s12" id="twitter-btn-div">
															{% if twitter_auth_url %}
																<a href="{{ twitter_auth_url }}" target="_target" class="btn waves-effect waves-light indigo accent-3 twitter-btn" id="twitter-btn-link">Link My Twitter Account</a>
															{% else %}
																<button class="waves-effect waves-light btn red twitter-btn" id="twitter-btn-unlink">Unlink My Twitter Account</button>
															{% endif %}
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>

									<!-- Facebook Card -->
									<div class="col s12 m6">
										<div class="white">
											<div class="card" id="profile-page-header">
												<div class="card-image header-img">
													<img alt="user background" class="activator" src="{% static "images/social-logos/bg-fb.png" %}">
												</div>
												<figure class="card-profile-image">
													<img alt="profile image" class="circle z-depth-2 responsive-imgMod activator" src="{% static "images/social-logos/facebook.png" %}">
												</figure>
												<div class="card-content">
													<div class="row social-btn-row">
														<div class="col s12" style="text-align: center;">
															<button class="btn waves-effect waves-light red" type="submit" name="action" style="font-size: 12px;" disabled="">Coming Soon</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>

									<!-- LinkedIn Card -->
									<div class="col s12 m6">
										<div class="white">
											<div class="card" id="profile-page-header">
												<div class="card-image header-img">
													<img alt="user background" class="activator" src="{% static "images/social-logos/bg-lk.jpg" %}">
												</div>
												<figure class="card-profile-image">
													<img alt="profile image" class="circle z-depth-2 responsive-imgMod activator" src="{% static "images/social-logos/linkedin.png" %}">
												</figure>
												<div class="card-content">
													<div class="row social-btn-row">
														<div class="col s12" style="text-align: center;">
															<button class="btn waves-effect waves-light red" type="submit" name="action" style="font-size: 12px;" disabled="">Coming Soon</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>

									<!-- GooglePlus Card -->
									<div class="col s12 m6">
										<div class="white">
											<div class="card" id="profile-page-header">
												<div class="card-image header-img">
													<img alt="user background" class="activator" src="{% static "images/social-logos/bg-gp.jpg" %}">
												</div>
												<figure class="card-profile-image">
													<img alt="profile image" class="circle z-depth-2 responsive-imgMod activator" src="{% static "images/social-logos/gplus.png" %}">
												</figure>
												<div class="card-content">
													<div class="row social-btn-row">
														<div class="col s12" style="text-align: center;">
															<button class="btn waves-effect waves-light red" type="submit" name="action" style="font-size: 12px;" disabled="">Coming Soon</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>
						<div class="col-md-12">
							<a type="button" name="next" class="btn blue darken-2 m-b-xs next">Next Step</a>
						</div>
					</fieldset>
					<fieldset>
						<form action="../process_onboarding/" method="post" id="onboarding_form">
		                    <div class="wizard clearfix">
		                        <div class="steps clearfix">
		                            <ul style="width: 100%;" class="tabs">
		                                <li class="tab">
		                                    <a class="active">Personal Info</a>
		                                </li>
										<div class="indicator" style="right: 0px; left: 0px;"></div>
		                            </ul>
		                        </div>
		                        <section>
		                            <div class="row" style="margin-top:70px;">
		                                <div class="col m6">
		                                    <div class="row">
		                                        <div class="input-field col m6 s12">
		                                            <label for="firstname">First name</label>
		                                            <input id="firstname" name="firstname" type="text" class="required validate" aria-required="true" data-init="{{ user.first_name }}" value="{{ user.first_name }}">
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <label for="lastname">Last name</label>
		                                            <input id="lastname" name="lastname" type="text" class="required validate" aria-required="true" data-init="{{ user.last_name }}" value="{{ user.last_name }}">
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <label for="email">Email Address</label>
		                                            <input id="email" name="email" type="email" class="required validate" aria-required="true" data-init="{{ user.email }}" value="{{ user.email }}">
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <select id="gender" name="gender" class="required validate" aria-required="true" data-init="{{ user.gender }}" >
		                                                <option selected disabled>Select One Gender</option>
		                                                {% if user.gender == 'M' %}
		                                                    <option value="F">Female</option>
		                                                    <option value="M" selected>Male</option>
		                                                    <option value="O">Other</option>
		                                                {% elif user.gender == 'F' %}
		                                                    <option value="F" selected>Female</option>
		                                                    <option value="M">Male</option>
		                                                    <option value="O">Other</option>
		                                                {% elif user.gender == 'O' %}
		                                                    <option value="F">Female</option>
		                                                    <option value="M">Male</option>
		                                                    <option value="O" selected>Other</option>
														{% else %}
		                                                    <option value="F">Female</option>
		                                                    <option value="M">Male</option>
		                                                    <option value="O">Other</option>
		                                                {% endif %}
		                                            </select>
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <select id="country" name="country" class="required validate" aria-required="true" data-init="{{ user.country }}">
		                                                <option selected disabled>Where are you from ?</option>
		                                                {% for country in countries %}
		                                                    {% if user.country == country %}
		                                                        <option selected >{{ country.name }}</option>
		                                                    {% else %}
		                                                        <option>{{ country.name }}</option>
		                                                    {% endif %}
		                                                {% endfor %}
		                                            </select>
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <label for="birthdate">Birthdate</label>
		                                            <input id="birthdate" name="birthdate" type="date" class="datepicker required" data-init="{{ user.get_birthdate }}">
		                                        </div>
		                                        <div class="input-field col m12">
		                                            <label for="feedtitle">RSS Feed Title</label>
		                                            <input id="feedtitle" name="feedtitle" type="text" data-init="{{ user.rss_feed_title }}" value="{{ user.rss_feed_title }}">
		                                        </div>
		                                    </div>
		                                </div>
		                                <div class="col m6">
		                                    <div class="row">
		                                        <div class="input-field col m6 s12">
		                                            <label for="company_name">Company name</label>
		                                            <input id="company_name" name="company_name" type="text" class="validate" data-init="{{ user.company_name }}" value="{{ user.company_name }}">
		                                        </div>
		                                        <div class="input-field col m6 s12">
		                                            <label for="company_website">Company Website</label>
		                                            <input id="company_website" name="company_website" type="text" class="validate" data-init="{{ user.company_website }}"  value="{{ user.company_website }}">
		                                        </div>
		                                        <div class="input-field col s12">
		                                            <label for="job">Job Title</label>
		                                            <input id="job" name="job" type="text" class="validate" data-init="{{ user.job }}" value="{{ user.job }}">
		                                        </div>
		                                        <div class="input-field col s12">
		                                            <textarea id="description" name="description" class="validate materialize-textarea description-textarea" data-init="{{ user.description }}">{{ user.description }}</textarea>
		                                            <label for="description">Description</label>
		                                        </div>

		                                    </div>
		                                </div>
		                            </div>
		                        </section>
							</div>
							{% csrf_token %}
							{% if next %}
								<input type="hidden" name="next" value="{{ next }}" />
							{% endif %}
							<input id="interest1" name="interest1" type="hidden" value="">
							<input id="interest2" name="interest2" type="hidden" value="">
							<input id="interest3" name="interest3" type="hidden" value="">
		                </form>
		                <div class="row" style="text-align:right;">
		                    <a class="waves-effect waves-light btn red m-b-xs" id="reset-btn">Reset</a>
		                    <a class="waves-effect waves-light btn blue m-b-xs" id="save-btn">Save</a>
		                </div>
					</fieldset>
				</div>
			</main>
		</div>

		<!-- Javascripts -->
		<script type="text/javascript" src="{% static "plugins/jquery/jquery-2.2.0.min.js" %}"></script>
		<script type="text/javascript" src="{% static "plugins/materialize/js/materialize.min.js" %}"></script>
		<script type="text/javascript" src="{% static "plugins/material-preloader/js/materialPreloader.min.js" %}"></script>
		<script type="text/javascript" src="{% static "plugins/sweetalert/sweetalert.min.js" %}"></script>
		<script type="text/javascript" src="{% static "plugins/js-cookie/js.cookie-2.1.3.min.js" %}"></script>
		<script type="text/javascript" src="{% static "js/admin-social-linking.js" %}"></script>
		<script type="text/javascript" src="{% static "js/alpha.min.js" %}"></script>

		<script>
			$(document).ready(function (e) {
				//jQuery time
				var current_fs, next_fs, previous_fs; //fieldsets
				var left, opacity, scale; //fieldset properties which we will animate
				var animating; //flag to prevent quick multi-click glitches

				$(".next").click(function(){
					if(animating) return false;
					animating = true;

					current_fs = $(this).parent().parent();
					next_fs = $(this).parent().parent().next();

					//activate next step on progressbar using the index of next_fs
					$("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

					//show the next fieldset
					next_fs.show();
					//hide the current fieldset with style
					current_fs.animate({opacity: 0}, {
						step: function(now, mx) {
							//as the opacity of current_fs reduces to 0 - stored in "now"
							//1. scale current_fs down to 80%
							scale = 1 - (1 - now) * 0.2;
							//2. bring next_fs from the right(50%)
							left = (now * 50)+"%";
							//3. increase opacity of next_fs to 1 as it moves in
							opacity = 1 - now;
							current_fs.css({'transform': 'scale('+scale+')'});
							next_fs.css({'left': left, 'opacity': opacity});
						},
						duration: 800,
						complete: function(){
							current_fs.hide();
							animating = false;
						},
						//this comes from the custom easing plugin
						easing: 'easeInOutBack'
					});
				});

				$(".submit").click(function(){
					return false;
				});

				var interests_required_number = 3;

				$('.interest-checkbox').on('change', function(evt) {

					var amount_checked = $('.interest-checkbox:checked').length;

					if(amount_checked > interests_required_number) {
						this.checked = false;
					}
					else if (amount_checked == interests_required_number) {
						$("#interests-btn").prop("disabled", false);
						$("#interests-btn").html("Next Step");
					}
					else{
						$("#interests-btn").prop("disabled", true);
						$("#interests-btn").html("Select 3 Interests to Continue ...");
					}
				});

				// =================================================================== FORM SUBMITTING ===========================================================
				$('#country').material_select(); // Select Initialization
				$("#gender").material_select(); // Select Initialization

				var birthdate_input = $("#birthdate");

				var birthdate = birthdate_input.pickadate({
			      format: 'dd/mm/yyyy',
				  closeOnSelect: true,
				  closeOnClear: true,
			      selectMonths: true, // Creates a dropdown to control month
			      selectYears: 50, // Creates a dropdown of 15 years to control year
			  	});

			  	var picker = birthdate.pickadate('picker');
				var user_birthdate = birthdate_input.data("init");

				if (user_birthdate != "None")
					picker.set('select', user_birthdate, { format: 'dd/mm/yyyy' });

				form_fields = [
					'firstname',
					'lastname',
					'email',
					'birthdate',
					'country', // Select
					'gender', // Select
					'feedtitle',
					'description', // TextArea
					'job',
					'company_name',
					'company_website',
				]

				function clearFields(){
					for (field in form_fields){
						//console.log(social_networks[field]+ " = " +$("#"+social_networks[field]).val());
						var input = $("#"+form_fields[field]);
						input.val(input.data("init"));
					}
					$("#country").material_select();
					$("#gender").material_select();
				}

				$("#reset-btn").click(function() {
			        swal({
			            title: "Are you sure ?",
			            text: "Do you really want to reset all the fields ?",
			            type: "warning",
			            showCancelButton: true,
			            confirmButtonColor: "#DD6B55",
			            confirmButtonText: "Yes, please reset!",
			            cancelButtonText: "Please No!",
			            closeOnConfirm: true,
			            closeOnCancel: true
			        }, function(){
			            clearFields();
						swal.close();
			        });
			    });

				$("#save-btn").click( function(event) {
					for (i = 0; i < interests_required_number; i++) {
						$('input#interest'+(i+1)).val($("#"+$('.interest-checkbox:checked')[i].id).data("name"));
					}

					$("#onboarding_form").submit();
				});
			});
		</script>
	</body>
</html>
