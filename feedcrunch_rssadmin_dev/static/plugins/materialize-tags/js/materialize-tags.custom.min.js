!function(a){"use strict";function c(a){return"chip"}function d(a){return a?a.toString():a}function e(a){return this.itemValue(a)}function f(a){return null}function g(a,b){b.hide().fadeIn()}function h(b,c){this.itemsArray=[],this.$element=a(b),this.$element.hide(),this.objectItems=c&&c.itemValue,this.placeholderText=b.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=a('<div class="materialize-tags"></div>'),this.$input=a('<input type="text" class="n-tag"  placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$label=this.$element.parent().find("label"),this.$element.before(this.$container),this.build(c),this.$label.on("click",function(){a(this).addClass("active"),a(this).next(".materialize-tags").find("input.n-tag").focus()}),this.$input.on("focus",function(){var b=a(this).parents(".materialize-tags").parent().find("label");a(this).parents(".materialize-tags").addClass("active"),b.hasClass("active")||b.addClass("active")}).on("focusout",function(){var b=a(this).parents(".materialize-tags"),c=b.find("span.chip");b.removeClass("active"),0==c.length&&0==a(this).val().length&&b.parent().find("label").removeClass("active")})}function i(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function j(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function l(a){return a?k.text(a).html():""}function n(b,c){var d=!1;return a.each(c,function(a,c){if("number"==typeof c&&b.which===c)return d=!0,!1;if(b.which===c.which){var e=!c.hasOwnProperty("altKey")||b.altKey===c.altKey,f=!c.hasOwnProperty("shiftKey")||b.shiftKey===c.shiftKey,g=!c.hasOwnProperty("ctrlKey")||b.ctrlKey===c.ctrlKey;if(e&&f&&g)return d=!0,!1}}),d}var b={tagClass:c,itemValue:d,itemText:e,itemTitle:f,freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[9,13,44,188],onTagExists:g,trimValue:!0,allowDuplicates:!1};h.prototype={constructor:h,add:function(b,c,d){var e=this;if(!(e.options.maxTags&&e.itemsArray.length>=e.options.maxTags)&&(b===!1||b)){if("string"==typeof b&&e.options.trimValue&&(b=a.trim(b)),"object"==typeof b&&!e.objectItems)throw"Can't add objects when itemValue option is not set";if(!b.toString().match(/^\s*$/)){if("string"==typeof b&&"INPUT"===this.$element[0].tagName){var f=b.split(",");if(f.length>1){for(var g=0;g<f.length;g++)this.add(f[g],!0);return void(c||e.pushVal())}}var h=e.options.itemValue(b),i=e.options.itemText(b),j=e.options.tagClass(b),k=e.options.itemTitle(b),m=a.grep(e.itemsArray,function(a){return e.options.itemValue(a)===h})[0];if(!m||e.options.allowDuplicates){if(!(e.items().toString().length+b.length+1>e.options.maxInputLength)){var o=a.Event("beforeItemAdd",{item:b,cancel:!1,options:d});if(e.$element.trigger(o),!o.cancel){e.itemsArray.push(b);var p=a('<span class="'+l(j)+(null!==k?'" title="'+k:"")+'">'+l(i)+'<i class="material-icons" data-role="remove">close</i></span>');p.data("item",b),e.findInputWrapper().before(p),p.after(" "),c||e.pushVal(),e.options.maxTags!==e.itemsArray.length&&e.items().toString().length!==e.options.maxInputLength||e.$container.addClass("materialize-tags-max"),e.$element.trigger(a.Event("itemAdded",{item:b,options:d}))}}}else if(e.options.onTagExists){var n=a(".tag",e.$container).filter(function(){return a(this).data("item")===m});e.options.onTagExists(b,n)}}}},remove:function(b,c,d){var e=this;if(e.objectItems&&(b="object"==typeof b?a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==e.options.itemValue(b)}):a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==b}),b=b[b.length-1]),b){var f=a.Event("beforeItemRemove",{item:b,cancel:!1,options:d});if(e.$element.trigger(f),f.cancel)return;a(".chip",e.$container).filter(function(){return a(this).data("item")===b}).remove(),a.inArray(b,e.itemsArray)!==-1&&e.itemsArray.splice(a.inArray(b,e.itemsArray),1)}c||e.pushVal(),e.options.maxTags>e.itemsArray.length&&e.$container.removeClass("materialize-tags-max"),e.$element.trigger(a.Event("itemRemoved",{item:b,options:d}))},removeAll:function(){var b=this;for(a(".chip",b.$container).remove();b.itemsArray.length>0;)b.itemsArray.pop();b.pushVal()},refresh:function(){var b=this;a(".chip",b.$container).each(function(){var c=a(this),d=c.data("item"),f=(b.options.itemValue(d),b.options.itemText(d)),g=b.options.tagClass(d);c.attr("class",null),c.addClass("tag "+l(g)),c.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=l(f)})},items:function(){return this.itemsArray},pushVal:function(){var b=this,c=a.map(b.items(),function(a){return b.options.itemValue(a).toString()});b.$element.val(c,!0).trigger("change")},build:function(c){var d=this;if(d.options=a.extend({},b,c),d.objectItems&&(d.options.freeInput=!1),i(d.options,"itemValue"),i(d.options,"itemText"),j(d.options,"tagClass"),d.options.typeaheadjs){var e=null,f={},g=d.options.typeaheadjs;a.isArray(g)?(e=g[0],f=g[1]):f=g,d.$input.typeahead(e,f).on("typeahead:selected",a.proxy(function(a,b){f.valueKey?d.add(b[f.valueKey]):d.add(b),d.$input.typeahead("val","")},d))}d.$container.on("click",a.proxy(function(a){d.$element.attr("disabled")||d.$input.removeAttr("disabled"),d.$input.focus()},d)),d.options.addOnBlur&&d.options.freeInput&&d.$input.on("focusout",a.proxy(function(b){0===a(".typeahead, .twitter-typeahead",d.$container).length&&(d.add(d.$input.val()),d.$input.val(""))},d)),d.$container.on("keydown","input",a.proxy(function(b){var c=a(b.target);if(d.$element.attr("disabled"))return void d.$input.attr("disabled","disabled");var e=c.val(),f=d.options.maxChars&&e.length>=d.options.maxChars;d.options.freeInput&&(n(b,d.options.confirmKeys)||f)&&(d.add(f?e.substr(0,d.options.maxChars):e),c.val(""),d.$input.typeahead&&d.$input.typeahead("val",""),b.preventDefault());var g=c.val().length;Math.ceil(g/5);c.attr("size",Math.max(this.inputSize,c.val().length))},d)),d.$container.on("click","[data-role=remove]",a.proxy(function(b){d.$element.attr("disabled")||d.remove(a(b.target).closest(".chip").data("item"))},d)),d.options.itemValue===b.itemValue&&"INPUT"===d.$element[0].tagName&&d.add(d.$element.val())},destroy:function(){var a=this;a.$container.off("keydown","input"),a.$container.off("click","[role=remove]"),a.$container.remove(),a.$element.removeData("materialtags"),a.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var b=this.$input[0],c=this.$container[0];b&&b.parentNode!==c;)b=b.parentNode;return a(b)}},a.fn.materialtags=function(b,c,d){var e=[];return this.each(function(){var f=a(this).data("materialtags");if(f)if(b||c){if(void 0!==f[b]){if(3===f[b].length&&void 0!==d)var g=f[b](c,null,d);else var g=f[b](c);void 0!==g&&e.push(g)}}else e.push(f);else f=new h(this,b),a(this).data("materialtags",f),e.push(f),a(this).val(a(this).val())}),"string"==typeof b?e.length>1?e:e[0]:e},a.fn.materialtags.defaults=b,a.fn.materialtags.Constructor=h;var k=a("<div />");a(function(){a("input[data-role=materialtags]").materialtags()})}(window.jQuery);
